<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates the standardized effect size for phylogenetic
diversity.
See Details for more information."><title>Phylogenetic diversity standardized for species richness — rast.pd.ses • phyloraster</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetic diversity standardized for species richness — rast.pd.ses"><meta property="og:description" content="Calculates the standardized effect size for phylogenetic
diversity.
See Details for more information."><meta property="og:image" content="https://gabferreira.github.io/phyloraster/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">phyloraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/phyloraster-vignette.html">Introduction to the phyloraster package and its functionalities</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gabferreira/phyloraster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Phylogenetic diversity standardized for species richness</h1>
      <small class="dont-index">Source: <a href="https://github.com/gabferreira/phyloraster/blob/HEAD/R/rast.pd.ses.R" class="external-link"><code>R/rast.pd.ses.R</code></a></small>
      <div class="d-none name"><code>rast.pd.ses.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the standardized effect size for phylogenetic
diversity.
See Details for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rast.pd.ses</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  <span class="va">edge.path</span>,</span>
<span>  <span class="va">branch.length</span>,</span>
<span>  spat_alg <span class="op">=</span> <span class="st">"bootspat_str"</span>,</span>
<span>  spat_alg_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rprob <span class="op">=</span> <span class="cn">NULL</span>, rich <span class="op">=</span> <span class="cn">NULL</span>, fr_prob <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tip"</span>, <span class="st">"spat"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  aleats <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p></dd>


<dt>tree</dt>
<dd><p>phylo. A dated tree.</p></dd>


<dt>edge.path</dt>
<dd><p>matrix representing the paths through the tree from root
to each tip. See <code><a href="phylo.pres.html">phylo.pres</a></code></p></dd>


<dt>branch.length</dt>
<dd><p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="phylo.pres.html">phylo.pres</a></code></p></dd>


<dt>spat_alg</dt>
<dd><p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_naive.html" class="external-link">bootspat_naive</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_str.html" class="external-link">bootspat_str</a></code>, <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_ff.html" class="external-link">bootspat_ff</a></code>.</p></dd>


<dt>spat_alg_args</dt>
<dd><p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_naive.html" class="external-link">bootspat_naive</a></code>, <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_str.html" class="external-link">bootspat_str</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_ff.html" class="external-link">bootspat_ff</a></code></p></dd>


<dt>random</dt>
<dd><p>character. A character indicating the type of randomization.
The currently available randomization methods are "tip", "site", "species" or
"both" (site and species).</p></dd>


<dt>aleats</dt>
<dd><p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p></dd>


<dt>filename</dt>
<dd><p>character. Output filename</p></dd>


<dt>...</dt>
<dd><p>additional arguments passed for terra::app</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>SpatRaster</p>


<p>SpatRaster. The function returns the observed phylogenetic diversity,
the mean of the simulations calculated over n times, the standard deviation
of
the simulations, and the standardized effect size (SES) for the phylogenetic
diversity.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The spatial randomization (spat) keeps the richness exact and
samples
species presences proportionally to their observed frequency (i.e. number
of occupied pixels). The randomization will not assign values to cells with
nodata. The phylogenetic randomization shuffles taxa names across all taxa
included in phylogeny.</p>
<p>The spatial randomization (spat) keeps the richness exact and
samples species presences proportionally to their observed frequency
(i.e. number of occupied pixels). The randomization will not assign values
to cells with nodata. The phylogenetic randomization shuffles taxa names
across all taxa included in phylogeny.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Faith, D. P. (1992). Conservation evaluation and phylogenetic
diversity. Biological conservation, 61(1), 1-10.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="phylo.pres.html">phylo.pres</a></code>, <code><a href="inv.range.html">inv.range</a></code>,
<code><a href="geo.phylo.ses.html">geo.phylo.ses</a></code>,
<code><a href="rast.ed.ses.html">rast.ed.ses</a></code>, <code>rast.pd.ses</code>,
<code><a href="rast.we.ses.html">rast.we.ses</a></code>, <code><a href="rast.pe.ses.html">rast.pe.ses</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_str.html" class="external-link">bootspat_str</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_naive.html" class="external-link">bootspat_naive</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_ff.html" class="external-link">bootspat_ff</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/SESraster.html" class="external-link">SESraster</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gabriela Alves-Ferreira and Neander Heming</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=phyloraster" class="external-link">phyloraster</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=SESraster" class="external-link">SESraster</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"rast.presab.tif"</span>,</span></span>
<span class="r-in"><span>package<span class="op">=</span><span class="st">"phyloraster"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tree.nex"</span>,</span></span>
<span class="r-in"><span>package<span class="op">=</span><span class="st">"phyloraster"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="phylo.pres.html">phylo.pres</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span>, <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some species in the phylogeny 'tree' are missing from the</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                   SpatRaster 'x' and were dropped: Litoria_nigrofrenata, Litoria_bicolor, Litoria_fallax, Litoria_genimaculata, Litoria_andiirrmalin, Litoria_wilcoxii, Litoria_jungguy, Litoria_caerulea, Litoria_gracilenta, Litoria_chloris, Litoria_xanthomera, Cyclorana_brevipes, Cyclorana_novaehollandiae, Cyclorana_manya, Cyclorana_cultripes, Litoria_alboguttata, Cyclorana_longipes, Nyctimystes_dayi, Litoria_nannotis, Litoria_lorica, Litoria_rheocola, Litoria_nyakalensis, Litoria_infrafrenata</span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">rast.pd.ses</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">x</span>, edge.path <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">edge.path</span>,</span></span>
<span class="r-in"><span>                branch.length <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">branch.length</span>, aleats <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                random <span class="op">=</span> <span class="st">"spat"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rast.pd.ses-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Gabriela Alves-Ferreira, Flávio M. M. Mota, Neander Marcel Heming.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

