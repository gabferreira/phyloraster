<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate phylogenetic community metrics and their standardized effect sizes for raster data — geo.phylo.ses • phyloraster</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate phylogenetic community metrics and their standardized effect sizes for raster data — geo.phylo.ses"><meta name="description" content="Calculates the standardized effect size for phylogenetic
community metrics. See Details for more information."><meta property="og:description" content="Calculates the standardized effect size for phylogenetic
community metrics. See Details for more information."><meta property="og:image" content="https://gabferreira.github.io/phyloraster/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phyloraster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phyloraster-vignette.html">Introduction to the phyloraster package and its functionalities</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gabferreira/phyloraster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate phylogenetic community metrics and their standardized effect sizes for raster data</h1>
      <small class="dont-index">Source: <a href="https://github.com/gabferreira/phyloraster/blob/master/R/geo.phylo.R" class="external-link"><code>R/geo.phylo.R</code></a></small>
      <div class="d-none name"><code>geo.phylo.ses.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the standardized effect size for phylogenetic
community metrics. See Details for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">geo.phylo.ses</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  <span class="va">inv.R</span>,</span>
<span>  <span class="va">edge.path</span>,</span>
<span>  <span class="va">branch.length</span>,</span>
<span>  <span class="va">n.descen</span>,</span>
<span>  full_tree_metr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  spat_alg <span class="op">=</span> <span class="st">"bootspat_str"</span>,</span>
<span>  spat_alg_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rprob <span class="op">=</span> <span class="cn">NULL</span>, rich <span class="op">=</span> <span class="cn">NULL</span>, fr_prob <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  aleats <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p></dd>


<dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>phylo. A dated tree.</p></dd>


<dt id="arg-inv-r">inv.R<a class="anchor" aria-label="anchor" href="#arg-inv-r"></a></dt>
<dd><p>SpatRaster. Inverse of range size. See <code><a href="inv.range.html">inv.range</a></code></p></dd>


<dt id="arg-edge-path">edge.path<a class="anchor" aria-label="anchor" href="#arg-edge-path"></a></dt>
<dd><p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="phylo.pres.html">phylo.pres</a></code></p></dd>


<dt id="arg-branch-length">branch.length<a class="anchor" aria-label="anchor" href="#arg-branch-length"></a></dt>
<dd><p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="phylo.pres.html">phylo.pres</a></code></p></dd>


<dt id="arg-n-descen">n.descen<a class="anchor" aria-label="anchor" href="#arg-n-descen"></a></dt>
<dd><p>numeric. A Named numeric vector of number of descendants for
each branch. See <code><a href="phylo.pres.html">phylo.pres</a></code></p></dd>


<dt id="arg-full-tree-metr">full_tree_metr<a class="anchor" aria-label="anchor" href="#arg-full-tree-metr"></a></dt>
<dd><p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p></dd>


<dt id="arg-spat-alg">spat_alg<a class="anchor" aria-label="anchor" href="#arg-spat-alg"></a></dt>
<dd><p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_naive.html" class="external-link">bootspat_naive</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_str.html" class="external-link">bootspat_str</a></code>, <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_ff.html" class="external-link">bootspat_ff</a></code>.</p></dd>


<dt id="arg-spat-alg-args">spat_alg_args<a class="anchor" aria-label="anchor" href="#arg-spat-alg-args"></a></dt>
<dd><p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_naive.html" class="external-link">bootspat_naive</a></code>, <code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_str.html" class="external-link">bootspat_str</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_ff.html" class="external-link">bootspat_ff</a></code></p></dd>


<dt id="arg-aleats">aleats<a class="anchor" aria-label="anchor" href="#arg-aleats"></a></dt>
<dd><p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>positive integer. If <code>cores &gt; 1</code>, a 'parallel' package cluster with that many cores is created and used. You can also supply a cluster object. Ignored for functions that are implemented by terra in C++ (see under fun)</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>character. Output filename</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed for terra::app</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>SpatRaster. The function returns the observed value of the metric,
the mean of the simulations calculated over n times, the standard deviation
of the simulations, the standardized effect size (SES) for the metric,
and the p-values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.</p>
<p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gotelli, N. J. 2000.
Null model analysis of species co-occurrence patterns. –
Ecology 81: 2606–2621.</p>
<p>Heming, N. M., Mota, F. M. M. and Alves-Ferreira, G. 2023.
SESraster: raster randomization for null hypothesis testing.
https://CRAN.R-project.org/package=SESraster.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="phylo.pres.html">phylo.pres</a></code>,
<code><a href="inv.range.html">inv.range</a></code>,
<code><a href="geo.phylo.html">geo.phylo</a></code>,
<code><a href="rast.ed.ses.html">rast.ed.ses</a></code>,
<code><a href="rast.pd.ses.html">rast.pd.ses</a></code>,
<code><a href="rast.we.ses.html">rast.we.ses</a></code>,
<code><a href="rast.pe.ses.html">rast.pe.ses</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_str.html" class="external-link">bootspat_str</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_naive.html" class="external-link">bootspat_naive</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/bootspat_ff.html" class="external-link">bootspat_ff</a></code>,
<code><a href="https://hemingnm.github.io/SESraster/reference/SESraster.html" class="external-link">SESraster</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Neander Marcel Heming</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=phyloraster" class="external-link">phyloraster</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://CRAN.R-project.org/package=SESraster" class="external-link">"SESraster"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"rast.presab.tif"</span>,</span></span>
<span class="r-in"><span>package<span class="op">=</span><span class="st">"phyloraster"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tree.nex"</span>,</span></span>
<span class="r-in"><span>package<span class="op">=</span><span class="st">"phyloraster"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tses</span> <span class="op">&lt;-</span> <span class="fu">geo.phylo.ses</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>                     tree <span class="op">=</span> <span class="va">tree</span>,</span></span>
<span class="r-in"><span>                      spat_alg <span class="op">=</span> <span class="st">"bootspat_str"</span>,</span></span>
<span class="r-in"><span>                      spat_alg_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rprob <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                                           rich <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                                           fr_prob <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      aleats <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tses</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="geo.phylo.ses-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriela Alves-Ferreira, Flávio M. M. Mota, Neander Marcel Heming.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

