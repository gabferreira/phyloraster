test_that("Are the returned values correct", {

  x <- terra::rast(system.file("extdata", "rast.presab.tif", package="phyloraster"))

  rs.obs <- range_size(x)
  rs.expec <- c(5021016056, 196704341368, 4523101328,
                26914371304, 216777518096, 315599946680,
                46641760616, 283024696496, 2357368192,
                128975307408, 27880171288, 64016561600,
                105407823608, 46631895808, 98735292200,
                27268098232, 477612944, 274967476512,
                16970408776, 14130600736, 124447061616,
                247438117256, 328609848584,  909156688,
                47698700600, 288806916704, 10082989744,
                24131739952, 26022243368, 3076448840,
                24884175728, 20589961624, 84850742296)

  expect_equivalent(rs.obs, rs.expec)
})
